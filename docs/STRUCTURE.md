# Documentation Structure

This document describes the structure of the unified Sidechain documentation that combines both plugin (C++) and backend (Go) documentation.

## Generated Documentation Structure

```
docs/_build/html/
├── index.html                          # Main landing page
│   ├── Getting Started                 → getting-started.html
│   ├── Architecture                    → architecture.html
│   ├── Development                     → development.html
│   ├── API Reference                   → api/library_root.html (generated by Exhale)
│   └── Backend API Documentation       → backend/index.html
│
├── getting-started.html
├── architecture.html
├── development.html
│
├── api/
│   └── library_root.html              # Generated by Exhale from Doxygen XML
│
└── backend/
    ├── index.html                     # Backend documentation index
    ├── overview.html                  # Backend overview
    └── godoc/                         # Generated by GitHub Actions workflow
        ├── index.html                 # Go package docs index
        ├── pkg.html                   # Package listing
        └── pkg/github.com/zfogg/sidechain/backend/
            ├── internal/
            │   ├── handlers.html      # HTTP request handlers
            │   ├── models.html        # Data models
            │   ├── database.html      # Database operations
            │   ├── auth.html          # Authentication
            │   ├── stream.html        # Stream.io integration
            │   ├── storage.html       # File storage (S3)
            │   └── websocket.html     # WebSocket server
            └── ...
```

## Documentation Generation Flow

### 1. Plugin Documentation (C++)

**Process:**
- Doxygen scans C++ source files in `plugin/source/`
- Generates XML documentation files
- Exhale reads the XML and generates `api/library_root.rst`
- Sphinx includes this in the main documentation tree

**Dependencies:**
- Doxygen
- Breathe (Sphinx extension to read Doxygen XML)
- Exhale (Automatically generates API hierarchy)

### 2. Backend Documentation (Go)

**Process:**
- GitHub Actions workflow runs `godoc` as a web server
- Downloads all package HTML pages using `wget`
- Places them in `docs/_build/html/backend/godoc/`
- Sphinx links to them from `backend/index.rst`

**Dependencies:**
- Go (for `godoc` command)
- `wget` (for downloading godoc HTML pages)

### 3. Unified Output

- Single HTML site combining both plugin and backend docs
- Deployed automatically to GitHub Pages on push to `main`
- Accessible at: `https://<username>.github.io/sidechain/`

## Source Files

### Main Documentation
- `docs/index.rst` - Main documentation index (includes both plugin and backend)
- `docs/getting-started.rst` - Getting started guide
- `docs/architecture.rst` - Architecture overview
- `docs/development.rst` - Development guide

### Backend Documentation
- `docs/backend/index.rst` - Backend documentation index
- `docs/backend/overview.rst` - Backend architecture overview

### Generated Files
- `docs/api/library_root.rst` - Generated by Exhale (plugin API reference)
- `docs/_build/html/backend/godoc/**` - Generated by GitHub Actions (Go package docs)

## Building Locally

```bash
# Build plugin docs (requires Doxygen)
cd plugin
cmake -S . -B build-docs -DSIDECHAIN_BUILD_DOCS=ON
cmake --build build-docs --target docs

# Generate backend docs (requires Go)
cd backend
godoc -http=:6060 &
# Then use wget to download pages (see .github/workflows/docs.yml)

# Build Sphinx docs (requires Python + Sphinx)
cd docs
make html
```

## Deployment

Documentation is automatically built and deployed via GitHub Actions:
- Workflow: `.github/workflows/docs.yml`
- Triggered on: Push to `main` branch (when docs, plugin source, or backend source changes)
- Deploys to: GitHub Pages

