name: Notify Deploy Complete

on:
  workflow_run:
    workflows: [ "Build and Push Backend Docker Image" ]
    types: [ completed ]
    branches: [ main ]

jobs:
  notify:
    name: Deployment via Watchtower
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    steps:
      - name: Notify deployment
        run: |
          echo "✓ Docker image published to zfogg/sidechain-backend:latest"
          echo "✓ Watchtower on production server will auto-deploy within 30 seconds"
          echo ""
          echo "Deployment flow:"
          echo "1. GitHub Actions built and pushed new Docker image"
          echo "2. Watchtower detects new image (checks every 30s)"
          echo "3. Watchtower pulls new image and restarts containers"
          echo "4. No SSH deployment needed - fully automated!"
